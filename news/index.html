<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>New York Times Top Stories</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Flex:wght@100..1000;wdth@25..151;opsz@8..144&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Roboto Flex', sans-serif; overflow-anchor: none; }
      .story { display: block; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #ccc; }
      .story-title { font-weight: bold; margin: 10px 0; color: #333; }
      .story-abstract { color: #666; }
      .story-image img { max-width: 100%; height: auto; }
      .loading { text-align: center; }
    </style>
</head>
<body>
    
    <div id="stories"></div>
    <div class="loading">Loading more stories...</div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
          const apiKey = 'zlGqAV49zcWJtqpvlgomajXHXDLov2PO';
          const section = 'home';
          const url = `https://api.nytimes.com/svc/topstories/v2/${section}.json?api-key=${apiKey}`;
          
          // Variables to hold all stories and track which are currently displayed
          let allStories = [];
          let loadedStories = 0;
          const storiesPerLoad = 5; // Number of stories to show each time
          
          fetch(url)
              .then(response => response.json())
              .then(data => {
                  allStories = data.results; // Store all stories
                  loadMoreStories(); // Load the first set of stories
              })
              .catch(error => {
                  console.error('Error fetching data:', error);
              });
      
          function loadMoreStories() {
              // Calculate the next chunk of stories to load
              const nextStories = allStories.slice(loadedStories, loadedStories + storiesPerLoad);
              displayStories(nextStories);
              loadedStories += storiesPerLoad; // Update the count of loaded stories
              
              // Hide loading indicator if all stories are loaded
              if (loadedStories >= allStories.length) {
                  document.querySelector('.loading').style.display = 'none';
              }
          }
      
          function displayStories(stories) {
              const storiesContainer = document.getElementById('stories');
              
              stories.forEach(story => {
                  const div = document.createElement('div');
                  div.classList.add('story');
                  
                  const title = document.createElement('h2');
                  title.classList.add('story-title');
                  title.textContent = story.title;
                  
                  const abstract = document.createElement('p');
                  abstract.classList.add('story-abstract');
                  abstract.textContent = story.abstract;
                  
                  div.appendChild(title);
                  div.appendChild(abstract);
                  
                  if (story.multimedia && story.multimedia.length > 0) {
                      const img = document.createElement('img');
                      img.src = story.multimedia[0].url;
                      img.alt = story.multimedia[0].caption || 'NYT Story Image';
                      div.insertBefore(img, div.firstChild);
                  }
                  
                  if (story.url) {
                      const link = document.createElement('a');
                      link.href = story.url;
                      link.textContent = 'Read more';
                      link.target = '_blank';
                      div.appendChild(link);
                  }
                  
                  storiesContainer.appendChild(div);
              });
          }
      
          // Listen for scroll events to load more stories
          window.addEventListener('scroll', () => {
              // Check if the user has scrolled to the bottom of the page
              if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
                  loadMoreStories(); // Load more stories
              }
          });
      });
      </script>
      
      
  
</body>
</html>
